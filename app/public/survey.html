<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <title>Survey</title>
</head>
<style>
    img {
        width: 100%;
        object-fit: cover;
    }
</style>

<body>
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="/">Friend Finder</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-item nav-link active" href="/">Home <span class="sr-only">(current)</span></a>
                    <a class="nav-item nav-link float-right" href="#">Sign Out</a>
                </div>
            </div>
        </nav>

        <div class="jumbotron">
            <h1>Find your friend<i class="fas fa-user"></i></h1>
            <h4>Fill out this question survey to find your friend</h4>
            <h4>With 1 being strongly disagree and 5 being strongly agree</h4>
            <div class="form-group">
                <label for="exampleFormControlInput1">Name</label>
                <input type="text" class="form-control" id="name" placeholder="Name">
            </div>
            <div class="form-group">
                <label for="exampleFormControlInput1">Picture</label>
                <input type="text" class="form-control" id="picture" placeholder="picture">
            </div>
            <div class="form-group">
                <label for="exampleFormControlTextarea1">Your message</label>
                <textarea class="form-control" id="textarea" rows="3"></textarea>
            </div>
            <a href="/">Back to home</a>
        </div>



        <div class="form-group">
            <div class="form-group">
                <h2>Question 1</h2>
                <label for="question1">Lorem ipsum dolor sit amet, consectetur adipiscing elit</label>
                <select class="form-control" id="question1">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>

            <div class="form-group">
                <h2>Question 2</h2>
                <label for="question2">Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</label>
                <select class="form-control" id="question2">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
            <div class="form-group">
                <h2>Question 3</h2>
                <label for="question3">Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut
                    aliquip ex ea commodo consequat.</label>
                <select class="form-control" id="question3">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
            <div class="form-group">
                <h2>Question 4</h2>
                <label for="question4">Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
                    fugiat nulla pariatur.</label>
                <select class="form-control" id="question4">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>
            <div class="form-group">
                <h2>Question 5</h2>
                <label for="question5">Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia
                    deserunt mollit anim id est laborum.</label>
                <select class="form-control" id="question5">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>

            <div class="form-group">
                <h2>Question 6</h2>
                <label for="question6">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium
                    doloremque laudantium</label>
                <select class="form-control" id="question6">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>

            <div class="form-group">
                <h2>Question 7</h2>
                <label for="question7">Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed
                    quia consequuntur magni dolores eos qui</label>
                <select class="form-control" id="question7">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>

            <div class="form-group">
                <h2>Question 8</h2>
                <label for="question8">Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet,
                    consectetur</label>
                <select class="form-control" id="question8">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>

            <div class="form-group">
                <h2>Question 9</h2>
                <label for="question9">Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit
                    laboriosam, nisi ut aliquid ex ea commodi consequatur</label>
                <select class="form-control" id="question9">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>

            <div class="form-group">
                <h2>Question 10</h2>
                <label for="question10">Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil
                    molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatu</label>
                <select class="form-control" id="question10">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>

            <button id="submit-form" type="button" class="btn btn-primary" data-toggle="modal"
                data-target="#exampleModalLong">Submit</button>

            <!-- Modal -->
            <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog"
                aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLongTitle">Friend Found!!</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="matched-name"></div>
                            <div class="matched-body"></div>
                            <div class="matched-msg"></div>
                            <div class="user-body"></div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script type="text/javascript">
        function validateForm() {

        }
        $("#submit-form").on("click", function (event) {
            event.preventDefault();
            var newArr = []
            var name = $("#name").val().trim()
            var picture = $("#picture").val().trim()
            var textarea = $("#textarea").val().trim()
            var question1 = parseInt($("#question1").val().trim());
            var question2 = parseInt($("#question2").val().trim());
            var question3 = parseInt($("#question3").val().trim());
            var question4 = parseInt($("#question4").val().trim());
            var question5 = parseInt($("#question5").val().trim());
            var question6 = parseInt($("#question6").val().trim());
            var question7 = parseInt($("#question7").val().trim());
            var question8 = parseInt($("#question8").val().trim());
            var question9 = parseInt($("#question9").val().trim());
            var question10 = parseInt($("#question10").val().trim());

            newArr.push(question1, question2, question3, question4, question5,
                question6, question7, question8, question9, question10)
            var questionsArr = {
                name: name,
                photo: picture,
                scores: newArr,
            }
            var bestMatch = {
                name: '',
                difference: Infinity
            }

            $.post("/api/friends", questionsArr)
                .then(function (data) {
                });

            $.get("/api/friends", function (data) {
                for (var i = 0; i < data.length - 1; i++) {
                    var difference = 0;
                    for (var j = 0; j < data[i].scores.length; j++) {
                        difference += Math.abs(data[i].scores[j] - questionsArr.scores[j])
                        if (j === (data[i].scores.length - 1)) {
                            if (bestMatch.difference > difference) {
                                bestMatch.difference = difference
                                bestMatch.name = data[i].name
                                bestMatch.photo = data[i].photo
                                bestMatch.message = data[i].message
                            }
                        }
                    }
                }
                console.log(bestMatch)
                $(".matched-name").text(bestMatch.name)
                $(".matched-msg").text(bestMatch.message)
                $(".matched-body").empty()
                $(".matched-body").append("<img src=" + bestMatch.photo + ">")
            })
        });
    </script>


</body>

</html>